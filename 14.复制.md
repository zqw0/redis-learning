## 复制  
**介绍**：在redis中，用户可以通过执行SLAVEOF命令或者设置slaveof选项，让一个服务器去复制另一个服务器，我们称呼**被复制的服务器为主服务器**，而**对主服务器进行复制的服务器则被称为从服务器**。举例如下：  
假设现在有两个redis服务器，地址分别为127.0.0.1:6379和127.0.0.1:12345，如果我们向服务器127.0.0.1:12345发送以下命令：
```
127.0.0.1:12345> SLAVEOF 127.0.0.1 6379
OK
```
那么**服务器127.0.0.1:12345将称为127.0.0.1:6379的从服务器，理所当然127.0.0.1:6379也会成为127.0.0.1:12345的主服务器**。  
**特性**：进行复制中的主从服务器双方的数据将保存相同的数据，概念上将这种现象称作"数据库状态一致"，"或简称一致"。   
## 旧版复制功能的实现    
redis的复制功能分为**同步**和**命令传播**两个操作：  
（1）同步操作用于将从服务器的数据库状态更新至主服务器当前 所处的状态。  
（2）命令传播操作用于在主服务器的数据库状态被修改，导致主从服务器的数据库状态出现不一致时，让主从服务器的数据库重新回到一致状态。  
## 同步  
当客户端向从服务器发送SLAVEOF命令，**要求从服务器复制主服务器时，从服务器首先需要执行同步操作**。同步操作需要向主服务器发送SYNC命令来完成，以下是SYNC命令执行步骤：  
（1）从服务器向主服务器发送SYNC命令。  
（2）收到SYNC命令的主服务器执行BGSAVE命令命令，在后天生成一个RDB文件，并使用一个缓冲区记录从现在开始执行的所有写命令。  
（3）当主服务器的BGSAVE命令执行完毕时，主服务器会将BGSAVE命令生存的RDB文件发送给从服务器，从服务器接收并载入这个RDB文件，将字节的数据库状态更新至主服务器执行BGSAVE命令时的数据库状态。  
（4）主服务器将记录在缓冲区里面的所有写命令发送给从服务器，从服务器执行这些写命令，将自己的数据库状态更新至主服务器数据库当前所处的状态。  
## 命令传播  


